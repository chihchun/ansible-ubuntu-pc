
- name: Install packages
  block:
  - name: install build tools packages
    apt:
      name: '{{ item.name }}'
      state: '{{ item.state | default("present") }}'
      purge: yes

    with_items:
      - name: devscripts
      - name: build-essential

  # - name: install docker
  #   import_tasks: docker.yml

  - name: install desktop packages
    apt:
      name: '{{ item.name }}'
      state: '{{ item.state | default("present") }}'
      purge: yes

    with_items:
      - name: terminator
      - name: gdebi

  - name: install language support for zh
    shell: apt install -y $(check-language-support -l zh-hant) | true
    register: language_support

  - name: install Chinese language packages and fcitx
    apt:
      name: '{{ item.name }}'
      state: '{{ item.state | default("present") }}'
      purge: yes

    with_items:
      - name: fcitx
      - name: fcitx-chewing

  - name: install sync tools
    apt:
      name: '{{ item.name }}'
      state: '{{ item.state | default("present") }}'
      purge: yes

    with_items:
      - name: unison
      - name: rsync

  - name: install zim
    import_tasks: zim.yml

  - name: install proprietary software
    import_tasks: proprietary.yml

  become: yes
  become_user: root

- name: Setup for personal settings.
  block:
  - name: Setup fcitx
    command: "im-config -n fcitx"

  - name: Change default shell to zsh
    shell: chsh -s $(which zsh) "{{ansible_ssh_user}}"
    become: yes
    become_user: root

  - name: ohmyzsh zsh configuration
    git:
      repo: 'https://github.com/chihchun/oh-my-zsh.git'
      dest: "{{ansible_env.HOME}}/.oh-my-zsh"
      version: chihchun
